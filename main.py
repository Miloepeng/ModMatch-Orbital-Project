from ModScrape import moduleScrape, descScrape
import csv
import time
from selenium.common.exceptions import TimeoutException

start = time.perf_counter()

#modules = ["CS1101S", "CS2030S", "CS2040S", "CS2100", "CS2101", "CS2103T", "CS2106", "CS2109S", "CS3230", "CS1231S", "MA1521", "MA1522", "ST2334"]
modules = ['ACC1701X', 'DAO2703', 'MNO1706X', 'SC1101E', 'EL1101E', 'PE2101P', 'GE2103', 'XD3103', 'GE3253', 'GE3255', 'GE3256', 'SPH2002', 'SC2226', 'NUR1113A', 'CDE2300', 'CDE2310', 'EG2201A', 'EG2310', 'BT1101', 'DSA1101', 'DSE1101', 'IE1111R', 'SPH1904', 'ST1131', 'TCX2002', 'GEA1000', 'GEA1000N', 'GEC1000', 'GEC1001', 'GEC1002', 'GEC1003', 'GEC1004', 'GEC1005', 'GEC1006', 'GEC1007', 'GEC1008', 'GEC1009', 'GEC1010', 'GEC1011', 'GEC1012', 'GEC1013', 'GEC1014', 'GEC1015', 'GEC1016', 'GEC1017', 'GEC1018', 'GEC1019', 'GEC1020', 'GEC1021', 'GEC1022', 'GEC1023', 'GEC1024', 'GEC1025', 'GEC1026', 'GEC1027', 'GEC1028', 'GEC1029', 'GEC1030', 'GEC1031', 'GEC1032', 'GEC1033', 'GEC1034', 'GEC1034T', 'GEC1035', 'GEC1036', 'GEC1037', 'GEC1038', 'GEC1039', 'GEC1040', 'GEC1040T', 'GEC1041', 'GEC1042', 'GEC1043', 'GEC1044', 'GEC1045', 'GEC1046', 'GEC1048', 'GEC1049', 'GEC1050', 'GEC1051', 'GEC1052', 'GEC1053', 'HSA1000', 'NHS2098', 'RVC1000', 'RVC1001', 'RVC2000', 'UHB2204', 'NHS2019', 'UHB2206', 'NHS2020', 'UHB2207', 'NHS2021', 'UHB2208', 'NHS2022', 'UHB2209', 'NHS2023', 'UHB2210', 'NHS2024', 'UHB2211', 'NHS2025', 'UHB2214', 'NHS2028', 'USE2209', 'NHS2029', 'USE2305', 'NHS2031', 'USE2306', 'NHS2032', 'USE2307', 'NHS2033', 'USE2308', 'NHS2034', 'USE2309', 'NHS2035', 'USE2310', 'NHS2036', 'USE2313', 'NHS2039', 'USE2314', 'NHS2040', 'USE2315', 'NHS2041', 'USE2316', 'NHS2042', 'USE2319', 'NHS2045', 'USE2322', 'NHS2048', 'USE2323', 'NHS2049', 'USE2324', 'NHS2050', 'USE2325', 'NHS2051', 'USP3501', 'NHS3001', 'GEI1000', 'GEI1001', 'GEI1002', 'AR2524', 'CM3267', 'COS1000', 'CS1010E', 'CS1010S', 'CS1101S', 'CS2030', 'CS2030S', 'CS2113', 'CS2113T', 'ID2116', 'LSM2302', 'ZB2201', 'NM2207', 'SP2273', 'TCN1005', 'TCX2001', 'TEE2101', 'TIC2001', 'TIE2030', 'GEN2050X', 'GEN2060X', 'GEN2061X', 'GEN2062X', 'GEN2070X', 'GEN2050Y', 'GEN2060Y', 'GEN2061Y', 'GEN2062Y', 'GEN2070Y', 'GESS1000', 'GESS1000T', 'GESS1001', 'GESS1002', 'GESS1003', 'GESS1004', 'GESS1005', 'GESS1006', 'GESS1007', 'GESS1008', 'GESS1009', 'GESS1010', 'GESS1011', 'GESS1012', 'GESS1013', 'GESS1014', 'GESS1015', 'GESS1016', 'GESS1017', 'GESS1018', 'GESS1019', 'GESS1020', 'GESS1021', 'GESS1022', 'GESS1023', 'GESS1024', 'GESS1025', 'GESS1026', 'GESS1027', 'GESS1028', 'GESS1029', 'GESS1030', 'GESS1031', 'GESS1032', 'GESS1033', 'GESS1034', 'GESS1035', 'GESS1036', 'GESS1036T', 'GESS1037', 'GESS1038', 'CDE2501', 'HSS1000', 'LC1025', 'SPH1901', 'RVSS1000', 'RVSS1001', 'RVSS1002', 'RVSS1003', 'RVSS1004', 'UCV2207', 'NHS2052', 'UHB2212', 'NHS2026', 'ULT2299D', 'NHS2004', 'UPC2209', 'NST2026', 'USE2304', 'NHS2030', 'USE2311', 'NHS2037', 'USE2312', 'NHS2038', 'USE2317', 'NHS2043', 'USE2318', 'NHS2044', 'USE2320', 'NHS2046', 'USE2321', 'NHS2047', 'USP3505', 'NHS3002', 'GEX1000', 'GEX1001', 'GEX1002', 'GEX1003', 'GEX1004', 'GEX1005', 'GEX1005T', 'GEX1006', 'GEX1007', 'GEX1009', 'GEX1010', 'GEX1011', 'GEX1012', 'GEX1013', 'GEX1014', 'GEX1015', 'GEX1016', 'GEX1017', 'GEX1018', 'GEX1019', 'GEX1020', 'GEX1021', 'GEX1022', 'GEX1023', 'GEX1024', 'GEX1025', 'GEX1026', 'GEX1027', 'GEX1028', 'GEX1029', 'GEX1030', 'GEX1031', 'GEX1032', 'ES2631', 'ES2660', 'HSH1000', 'MUH1101', 'RVX1000', 'RVX1001', 'RVX1002', 'RVX1003', 'RVX1004', 'RVX1005', 'UWC2101A', 'NTW2001', 'UWC2101B', 'NTW2002', 'UWC2101C', 'NTW2003', 'UWC2101D', 'NTW2004', 'UWC2101E', 'NTW2005', 'UWC2101F', 'NTW2006', 'UWC2101G', 'NTW2007', 'UWC2101H', 'NTW2008', 'UWC2101I', 'NTW2009', 'UWC2101J', 'NTW2010', 'UWC2101K', 'NTW2011', 'UWC2101L', 'NTW2012', 'UWC2101M', 'NTW2013', 'UWC2101N', 'NTW2014', 'UWC2101P', 'NTW2015', 'UWC2101Q', 'NTW2016', 'UWC2101R', 'NTW2017', 'UWC2101S', 'NTW2018', 'UWC2101T', 'NTW2019', 'UWC2101U', 'NTW2020', 'UWC2101V', 'NTW2021', 'UWC2101W', 'NTW2022', 'UWC2101X', 'NTW2023', 'UWC2101Y', 'NTW2024', 'UWC2101Z', 'NTW2025', 'UWC2101AA', 'NTW2026', 'UWC2101AB', 'NTW2027', 'UWC2101AC', 'NTW2028', 'NTW2029', 'NTW2030', 'NTW2031', 'NTW2032', 'NTW2033', 'NTW2034', 'NTW2035', 'NTW2036', 'NTW2037', 'NTW2038', 'NTW2039', 'UAR2206', 'NHS2008', 'UAR2207', 'NHS2009', 'UAR2208', 'NHS2010', 'ULT2298D', 'NHS2001', 'ULT2299A', 'NHS2002', 'ULT2299C', 'NHS2003', 'ULT2299D', 'NHS2004', 'ULT2299E', 'NHS2005', 'ULT2299F', 'NHS2006', 'ULT2299G', 'NHS2007', 'UPI2205', 'NHS2011', 'UPI2207', 'NHS2012', 'UPI2208', 'NHS2013', 'UPI2210', 'NHS2014', 'UPI2211', 'NHS2015', 'UPI2212', 'NHS2016', 'UPI2213', 'NHS2017', 'UPI2214', 'NHS2018', 'CDE2501', 'EG2501', 'DTK1234', 'EG1311', 'IE2141', 'PF1101', 'IS1128', 'IS2218', 'IS2238', 'HSH1000', 'HSS1000', 'HSA1000', 'HSI1000', 'HSI2001', 'HSI2002', 'HSI2003', 'HSI2004', 'HSI2005', 'HSI2007', 'HSI2008', 'HSI2009', 'HSI2010', 'HSI2011', 'HSI2013', 'HSI2014', 'CS1231S', 'CS2030S', 'CS2040S', 'CS2100', 'CS2101', 'CS2103T', 'CS2106', 'CS2109S', 'CS3230', 'CS3231', 'CS3236', 'CS4231', 'CS4232', 'CS4234', 'CS3233', 'CS4257', 'CS4261', 'CS4268', 'CS4269', 'CS4330', 'CS5230', 'CS5234', 'CS5236', 'CS5237', 'CS5238', 'CS5330', 'CS3243', 'CS3244', 'CS3263', 'CS3264', 'CS4243', 'CS4244', 'CS4246', 'CS4248', 'CS4220', 'CS4261', 'CS4269', 'CS4277', 'CS4278', 'CS5215', 'CS5228', 'CS5242', 'CS5260', 'CS5340', 'CS5339', 'CS3241', 'CS3242', 'CS3247', 'CS4247', 'CS4350', 'CS3218', 'CS3240', 'CS3249', 'CS4240', 'CS4243', 'CS4249', 'CS4351', 'CS5237', 'CS5240', 'CS5343', 'CS5346', 'CS3235', 'CS4236', 'CS4230', 'CS4238', 'CS4239', 'CS3221', 'CS4257', 'CS4276', 'CS5231', 'CS5250', 'CS5321', 'CS5322', 'CS5331', 'CS5332', 'IFS4101', 'IFS4102', 'IFS4103', 'CS2102', 'CS3223', 'CS4221', 'CS4224', 'CS4225', 'CS4220', 'CS5226', 'CS5228', 'CS5322', 'CS2108', 'CS3245', 'CS4242', 'CS4248', 'CS4347', 'CS5246', 'CS5241', 'CS2105', 'CS3103', 'CS4222', 'CS4226', 'CS4231', 'CS3237', 'CS4344', 'CS5223', 'CS5224', 'CS5229', 'CS5248', 'CS5321', 'CS3210', 'CS3211', 'CS4231', 'CS4223', 'CS5222', 'CS5223', 'CS5224', 'CS5239', 'CS5250', 'CS2104', 'CS3211', 'CS4212', 'CS4215', 'CS3234', 'CS4216', 'CS5232', 'CS5214', 'CS5215', 'CS5218', 'CS3213', 'CS3219', 'CS4211', 'CS4218', 'CS4239', 'CS3203', 'CS3281', 'CS3282', 'CS3216', 'CS3217', 'CS3226', 'CS3234', 'CS5219', 'CS5232', 'CS5272', 'CS2220', 'CS5233', 'MA1521', 'MA1522', 'ST2334']
output = []
no_desc = []
no_comments = []
n = len(modules)

count = 1
for mod in modules:
    print("Scraping module " + str(count) + " out of " + str(n) + ": " + mod + "...")
    entry = {}
    entry["code"] = mod
    
    try:
        entry["description"] = descScrape(mod)
    except TimeoutException:
        entry["description"] = ""
        no_desc.append(mod)
        print("Modules w no description: ", no_desc)
        
    try:
        entry["comments"] = moduleScrape(mod)
    except TimeoutException:
        entry["comments"] = ""
        no_comments.append(mod)
        print("Modules w no comments: ", no_comments)
    finally:
        output.append(entry)
        print(mod + " done.")
        
    count += 1

with open("Module_Data.csv", "w", newline="", encoding="utf-8") as csvfile:
    fieldnames = ["code", "description", "comments"]
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()
    for entry in output:
        writer.writerow(entry)

print("End of Program")
end = time.perf_counter()
print(f"Time taken: {end - start:.6f} seconds")

